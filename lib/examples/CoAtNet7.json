{
  "name": "CoAtNet-7",
  "description": "A detailed implementation of the CoAtNet-7 architecture. This version aims for architectural accuracy with multiple blocks per stage. Note: The number of blocks in later stages is reduced for clarity, and available nodes are used to approximate the original's MBConv and relative attention blocks.",
  "nodes": [
    { "id": "input", "type": "inputNode", "position": { "x": 0, "y": 600 }, "data": { "channels": 3, "height": 224, "width": 224 } },

    { "id": "s0_conv1", "type": "conv2dNode", "position": { "x": 600, "y": 600 }, "data": { "in_channels": 3, "out_channels": 192, "kernel_size": 3, "stride": 2, "padding": 1 } },
    { "id": "s0_bn1", "type": "batchnorm2dNode", "position": { "x": 1200, "y": 600 }, "data": { "num_features": 192 } },
    { "id": "s0_relu1", "type": "reluNode", "position": { "x": 1800, "y": 600 }, "data": {} },
    { "id": "s0_conv2", "type": "conv2dNode", "position": { "x": 2400, "y": 600 }, "data": { "in_channels": 192, "out_channels": 192, "kernel_size": 3, "stride": 1, "padding": 1 } },
    { "id": "s0_bn2", "type": "batchnorm2dNode", "position": { "x": 3000, "y": 600 }, "data": { "num_features": 192 } },
    { "id": "s0_relu2", "type": "reluNode", "position": { "x": 3600, "y": 600 }, "data": {} },

    { "id": "s1_pool", "type": "maxpool2dNode", "position": { "x": 4200, "y": 600 }, "data": { "kernel_size": 3, "stride": 2, "padding": 1 } },
    { "id": "s1_b1_sepconv", "type": "separableconv2dNode", "position": { "x": 4800, "y": 400 }, "data": { "in_channels": 192, "out_channels": 192, "kernel_size": 3, "stride": 1, "padding": 1 } },
    { "id": "s1_b1_add", "type": "addNode", "position": { "x": 4800, "y": 800 }, "data": {} },
    { "id": "s1_b2_sepconv", "type": "separableconv2dNode", "position": { "x": 5400, "y": 400 }, "data": { "in_channels": 192, "out_channels": 192, "kernel_size": 3, "stride": 1, "padding": 1 } },
    { "id": "s1_b2_add", "type": "addNode", "position": { "x": 5400, "y": 800 }, "data": {} },

    { "id": "s2_downsample", "type": "separableconv2dNode", "position": { "x": 6000, "y": 600 }, "data": { "in_channels": 192, "out_channels": 256, "kernel_size": 3, "stride": 2, "padding": 1 } },
    { "id": "s2_b1_sepconv", "type": "separableconv2dNode", "position": { "x": 6600, "y": 400 }, "data": { "in_channels": 256, "out_channels": 256, "kernel_size": 3, "stride": 1, "padding": 1 } },
    { "id": "s2_b1_add", "type": "addNode", "position": { "x": 6600, "y": 800 }, "data": {} },
    { "id": "s2_b2_sepconv", "type": "separableconv2dNode", "position": { "x": 7200, "y": 400 }, "data": { "in_channels": 256, "out_channels": 256, "kernel_size": 3, "stride": 1, "padding": 1 } },
    { "id": "s2_b2_add", "type": "addNode", "position": { "x": 7200, "y": 800 }, "data": {} },

    { "id": "s3_downsample", "type": "conv2dNode", "position": { "x": 7800, "y": 600 }, "data": { "in_channels": 256, "out_channels": 512, "kernel_size": 3, "stride": 2, "padding": 1 } },
    { "id": "s3_b1_trans", "type": "transformerencoderlayerNode", "position": { "x": 8400, "y": 400 }, "data": { "d_model": 512, "nhead": 8 } },
    { "id": "s3_b1_add", "type": "addNode", "position": { "x": 8400, "y": 800 }, "data": {} },
    { "id": "s3_b2_trans", "type": "transformerencoderlayerNode", "position": { "x": 9000, "y": 400 }, "data": { "d_model": 512, "nhead": 8 } },
    { "id": "s3_b2_add", "type": "addNode", "position": { "x": 9000, "y": 800 }, "data": {} },
    { "id": "s3_b3_trans", "type": "transformerencoderlayerNode", "position": { "x": 9600, "y": 400 }, "data": { "d_model": 512, "nhead": 8 } },
    { "id": "s3_b3_add", "type": "addNode", "position": { "x": 9600, "y": 800 }, "data": {} },
    { "id": "s3_b4_trans", "type": "transformerencoderlayerNode", "position": { "x": 10200, "y": 400 }, "data": { "d_model": 512, "nhead": 8 } },
    { "id": "s3_b4_add", "type": "addNode", "position": { "x": 10200, "y": 800 }, "data": {} },

    { "id": "s4_downsample", "type": "conv2dNode", "position": { "x": 10800, "y": 600 }, "data": { "in_channels": 512, "out_channels": 1024, "kernel_size": 3, "stride": 2, "padding": 1 } },
    { "id": "s4_b1_trans", "type": "transformerencoderlayerNode", "position": { "x": 11400, "y": 400 }, "data": { "d_model": 1024, "nhead": 8 } },
    { "id": "s4_b1_add", "type": "addNode", "position": { "x": 11400, "y": 800 }, "data": {} },
    { "id": "s4_b2_trans", "type": "transformerencoderlayerNode", "position": { "x": 12000, "y": 400 }, "data": { "d_model": 1024, "nhead": 8 } },
    { "id": "s4_b2_add", "type": "addNode", "position": { "x": 12000, "y": 800 }, "data": {} },

    { "id": "pool", "type": "adaptiveavgpool2dNode", "position": { "x": 12600, "y": 600 }, "data": { "output_size": [1, 1] } },
    { "id": "flatten", "type": "flattenNode", "position": { "x": 13200, "y": 600 }, "data": {} },
    { "id": "linear", "type": "linearNode", "position": { "x": 13800, "y": 600 }, "data": { "in_features": 1024, "out_features": 1000 } }
  ],
  "edges": [
    { "id": "e_in_s0c1", "source": "input", "target": "s0_conv1" },
    { "id": "e_s0c1_s0b1", "source": "s0_conv1", "target": "s0_bn1" },
    { "id": "e_s0b1_s0r1", "source": "s0_bn1", "target": "s0_relu1" },
    { "id": "e_s0r1_s0c2", "source": "s0_relu1", "target": "s0_conv2" },
    { "id": "e_s0c2_s0b2", "source": "s0_conv2", "target": "s0_bn2" },
    { "id": "e_s0b2_s0r2", "source": "s0_bn2", "target": "s0_relu2" },

    { "id": "e_s0r2_s1p", "source": "s0_relu2", "target": "s1_pool" },
    { "id": "e_s1p_s1b1s", "source": "s1_pool", "target": "s1_b1_sepconv" },
    { "id": "e_s1p_s1b1a", "source": "s1_pool", "target": "s1_b1_add", "targetHandle": "input1" },
    { "id": "e_s1b1s_s1b1a", "source": "s1_b1_sepconv", "target": "s1_b1_add", "targetHandle": "input2" },
    { "id": "e_s1b1a_s1b2s", "source": "s1_b1_add", "target": "s1_b2_sepconv" },
    { "id": "e_s1b1a_s1b2a", "source": "s1_b1_add", "target": "s1_b2_add", "targetHandle": "input1" },
    { "id": "e_s1b2s_s1b2a", "source": "s1_b2_sepconv", "target": "s1_b2_add", "targetHandle": "input2" },

    { "id": "e_s1b2a_s2d", "source": "s1_b2_add", "target": "s2_downsample" },
    { "id": "e_s2d_s2b1s", "source": "s2_downsample", "target": "s2_b1_sepconv" },
    { "id": "e_s2d_s2b1a", "source": "s2_downsample", "target": "s2_b1_add", "targetHandle": "input1" },
    { "id": "e_s2b1s_s2b1a", "source": "s2_b1_sepconv", "target": "s2_b1_add", "targetHandle": "input2" },
    { "id": "e_s2b1a_s2b2s", "source": "s2_b1_add", "target": "s2_b2_sepconv" },
    { "id": "e_s2b1a_s2b2a", "source": "s2_b1_add", "target": "s2_b2_add", "targetHandle": "input1" },
    { "id": "e_s2b2s_s2b2a", "source": "s2_b2_sepconv", "target": "s2_b2_add", "targetHandle": "input2" },

    { "id": "e_s2b2a_s3d", "source": "s2_b2_add", "target": "s3_downsample" },
    { "id": "e_s3d_s3b1t", "source": "s3_downsample", "target": "s3_b1_trans" },
    { "id": "e_s3d_s3b1a", "source": "s3_downsample", "target": "s3_b1_add", "targetHandle": "input1" },
    { "id": "e_s3b1t_s3b1a", "source": "s3_b1_trans", "target": "s3_b1_add", "targetHandle": "input2" },
    { "id": "e_s3b1a_s3b2t", "source": "s3_b1_add", "target": "s3_b2_trans" },
    { "id": "e_s3b1a_s3b2a", "source": "s3_b1_add", "target": "s3_b2_add", "targetHandle": "input1" },
    { "id": "e_s3b2t_s3b2a", "source": "s3_b2_trans", "target": "s3_b2_add", "targetHandle": "input2" },
    { "id": "e_s3b2a_s3b3t", "source": "s3_b2_add", "target": "s3_b3_trans" },
    { "id": "e_s3b2a_s3b3a", "source": "s3_b2_add", "target": "s3_b3_add", "targetHandle": "input1" },
    { "id": "e_s3b3t_s3b3a", "source": "s3_b3_trans", "target": "s3_b3_add", "targetHandle": "input2" },
    { "id": "e_s3b3a_s3b4t", "source": "s3_b3_add", "target": "s3_b4_trans" },
    { "id": "e_s3b3a_s3b4a", "source": "s3_b3_add", "target": "s3_b4_add", "targetHandle": "input1" },
    { "id": "e_s3b4t_s3b4a", "source": "s3_b4_trans", "target": "s3_b4_add", "targetHandle": "input2" },

    { "id": "e_s3b4a_s4d", "source": "s3_b4_add", "target": "s4_downsample" },
    { "id": "e_s4d_s4b1t", "source": "s4_downsample", "target": "s4_b1_trans" },
    { "id": "e_s4d_s4b1a", "source": "s4_downsample", "target": "s4_b1_add", "targetHandle": "input1" },
    { "id": "e_s4b1t_s4b1a", "source": "s4_b1_trans", "target": "s4_b1_add", "targetHandle": "input2" },
    { "id": "e_s4b1a_s4b2t", "source": "s4_b1_add", "target": "s4_b2_trans" },
    { "id": "e_s4b1a_s4b2a", "source": "s4_b1_add", "target": "s4_b2_add", "targetHandle": "input1" },
    { "id": "e_s4b2t_s4b2a", "source": "s4_b2_trans", "target": "s4_b2_add", "targetHandle": "input2" },

    { "id": "e_s4b2a_pool", "source": "s4_b2_add", "target": "pool" },
    { "id": "e_pool_flat", "source": "pool", "target": "flatten" },
    { "id": "e_flat_lin", "source": "flatten", "target": "linear" }
  ]
}