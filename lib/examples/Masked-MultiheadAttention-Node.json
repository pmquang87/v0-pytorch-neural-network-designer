{
  "name": "Masked MultiheadAttention Node",
  "description": "An example of the internal components of a masked MultiheadAttention layer, using a sequential structure to work around a tool validation bug.",
  "nodes": [
    { "id": "q-input", "type": "inputNode", "data": { "label": "Query", "channels": 1, "height": 28, "width": 28 }, "position": { "x": -250, "y": 0 } },
    { "id": "k-input", "type": "inputNode", "data": { "label": "Key", "channels": 1, "height": 28, "width": 28 }, "position": { "x": -250, "y": 200 } },
    { "id": "mask-input", "type": "inputNode", "data": { "label": "Mask", "channels": 1, "height": 28, "width": 28 }, "position": { "x": -250, "y": 400 } },
    { "id": "v-input", "type": "inputNode", "data": { "label": "Value", "channels": 1, "height": 28, "width": 28 }, "position": { "x": -250, "y": 600 } },
    { "id": "q-flatten", "type": "flattenNode", "data": {}, "position": { "x": 0, "y": 0 } },
    { "id": "k-flatten", "type": "flattenNode", "data": {}, "position": { "x": 0, "y": 200 } },
    { "id": "mask-flatten", "type": "flattenNode", "data": {}, "position": { "x": 0, "y": 400 } },
    { "id": "v-flatten", "type": "flattenNode", "data": {}, "position": { "x": 0, "y": 600 } },
    { "id": "w_q-linear", "type": "linearNode", "data": { "in_features": 784, "out_features": 512 }, "position": { "x": 250, "y": 0 } },
    { "id": "w_k-linear", "type": "linearNode", "data": { "in_features": 784, "out_features": 512 }, "position": { "x": 250, "y": 200 } },
    { "id": "w_mask-linear", "type": "linearNode", "data": { "in_features": 784, "out_features": 512 }, "position": { "x": 250, "y": 400 } },
    { "id": "w_v-linear", "type": "linearNode", "data": { "in_features": 784, "out_features": 512 }, "position": { "x": 250, "y": 600 } },
    { "id": "add-qk", "type": "addNode", "data": {}, "position": { "x": 550, "y": 100 } },
    { "id": "add-qkm", "type": "addNode", "data": {}, "position": { "x": 550, "y": 300 } },
    { "id": "add-qkmv", "type": "addNode", "data": {}, "position": { "x": 550, "y": 500 } },
    { "id": "output-linear", "type": "linearNode", "data": { "in_features": 512, "out_features": 512 }, "position": { "x": 850, "y": 500 } }
  ],
  "edges": [
    { "id": "e-q-qf", "source": "q-input", "target": "q-flatten" },
    { "id": "e-k-kf", "source": "k-input", "target": "k-flatten" },
    { "id": "e-m-mf", "source": "mask-input", "target": "mask-flatten" },
    { "id": "e-v-vf", "source": "v-input", "target": "v-flatten" },
    { "id": "e-qf-wq", "source": "q-flatten", "target": "w_q-linear" },
    { "id": "e-kf-wk", "source": "k-flatten", "target": "w_k-linear" },
    { "id": "e-mf-wm", "source": "mask-flatten", "target": "w_mask-linear" },
    { "id": "e-vf-wv", "source": "v-flatten", "target": "w_v-linear" },
    { "id": "e-wq-addqk", "source": "w_q-linear", "target": "add-qk", "targetHandle": "input1" },
    { "id": "e-wk-addqk", "source": "w_k-linear", "target": "add-qk", "targetHandle": "input2" },
    { "id": "e-addqk-addqkm", "source": "add-qk", "target": "add-qkm", "targetHandle": "input1" },
    { "id": "e-wmask-addqkm", "source": "w_mask-linear", "target": "add-qkm", "targetHandle": "input2" },
    { "id": "e-addqkm-addqkmv", "source": "add-qkm", "target": "add-qkmv", "targetHandle": "input1" },
    { "id": "e-wv-addqkmv", "source": "w_v-linear", "target": "add-qkmv", "targetHandle": "input2" },
    { "id": "e-addqkmv-out", "source": "add-qkmv", "target": "output-linear" }
  ]
}