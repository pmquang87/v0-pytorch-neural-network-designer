{
    "name": "GPT-2 Block",
    "description": "A single block of a GPT-2 style decoder-only transformer. It includes masked self-attention and a feed-forward network.",
    "nodes": [
        {
            "id": "input-1",
            "type": "inputNode",
            "position": {
                "x": -400,
                "y": 250
            },
            "data": {
                "label": "Input Embeddings",
                "channels": 1,
                "height": 1024,
                "width": 768
            }
        },
        {
            "id": "mha-self-2",
            "type": "multiheadattentionNode",
            "position": {
                "x": 0,
                "y": 100
            },
            "data": {
                "embed_dim": 768,
                "num_heads": 12,
                "dropout": 0.1,
                "batch_first": true
            }
        },
        {
            "id": "add-1-3",
            "type": "addNode",
            "position": {
                "x": 300,
                "y": 250
            },
            "data": {}
        },
        {
            "id": "layernorm-1-4",
            "type": "layernormNode",
            "position": {
                "x": 500,
                "y": 250
            },
            "data": {
                "normalized_shape": [
                    768
                ]
            }
        },
        {
            "id": "ffn-linear-1-5",
            "type": "timeDistributedLinearNode",
            "position": {
                "x": 800,
                "y": 250
            },
            "data": {
                "in_features": 768,
                "out_features": 3072
            }
        },
        {
            "id": "ffn-relu-6",
            "type": "reluNode",
            "position": {
                "x": 1000,
                "y": 250
            },
            "data": {}
        },
        {
            "id": "ffn-linear-2-7",
            "type": "timeDistributedLinearNode",
            "position": {
                "x": 1200,
                "y": 250
            },
            "data": {
                "in_features": 3072,
                "out_features": 768
            }
        },
        {
            "id": "add-2-8",
            "type": "addNode",
            "position": {
                "x": 1500,
                "y": 250
            },
            "data": {}
        },
        {
            "id": "layernorm-2-9",
            "type": "layernormNode",
            "position": {
                "x": 1700,
                "y": 250
            },
            "data": {
                "normalized_shape": [
                    768
                ]
            }
        },
        {
            "id": "output-10",
            "type": "outputNode",
            "position": {
                "x": 2000,
                "y": 250
            },
            "data": {
                "label": "Output"
            }
        }
    ],
    "edges": [
        {
            "id": "e1-2q",
            "source": "input-1",
            "target": "mha-self-2",
            "targetHandle": "query"
        },
        {
            "id": "e1-2k",
            "source": "input-1",
            "target": "mha-self-2",
            "targetHandle": "key"
        },
        {
            "id": "e1-2v",
            "source": "input-1",
            "target": "mha-self-2",
            "targetHandle": "value"
        },
        {
            "id": "e1-3",
            "source": "input-1",
            "target": "add-1-3",
            "targetHandle": "input1"
        },
        {
            "id": "e2-3",
            "source": "mha-self-2",
            "target": "add-1-3",
            "targetHandle": "input2"
        },
        {
            "id": "e3-4",
            "source": "add-1-3",
            "target": "layernorm-1-4"
        },
        {
            "id": "e4-5",
            "source": "layernorm-1-4",
            "target": "ffn-linear-1-5"
        },
        {
            "id": "e5-6",
            "source": "ffn-linear-1-5",
            "target": "ffn-relu-6"
        },
        {
            "id": "e6-7",
            "source": "ffn-relu-6",
            "target": "ffn-linear-2-7"
        },
        {
            "id": "e4-8",
            "source": "layernorm-1-4",
            "target": "add-2-8",
            "targetHandle": "input1"
        },
        {
            "id": "e7-8",
            "source": "ffn-linear-2-7",
            "target": "add-2-8",
            "targetHandle": "input2"
        },
        {
            "id": "e8-9",
            "source": "add-2-8",
            "target": "layernorm-2-9"
        },
        {
            "id": "e9-10",
            "source": "layernorm-2-9",
            "target": "output-10"
        }
    ]
}