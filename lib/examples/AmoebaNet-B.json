{
    "name": "AmoebaNet-B",
    "description": "A complete, end-to-end representation of the AmoebaNet-B architecture, demonstrating the stem, a normal cell, a reduction cell, and the final classification head.",
    "nodes": [
        { "id": "stem_input", "type": "inputNode", "position": { "x": 0, "y": 1000 }, "data": { "channels": 3, "height": 224, "width": 224 } },
        { "id": "stem_conv", "type": "conv2dNode", "position": { "x": 250, "y": 1000 }, "data": { "in_channels": 3, "out_channels": 48, "kernel_size": 3, "stride": 2, "padding": 1 } },
        { "id": "stem_bn", "type": "batchnorm2dNode", "position": { "x": 500, "y": 1000 }, "data": { "num_features": 48, "label": "Stem Output (h1)" } },

        { "id": "normal_cell_prev_input", "type": "identityNode", "position": { "x": 750, "y": 800 }, "data": { "label": "h1" } },
        { "id": "normal_cell_curr_input", "type": "identityNode", "position": { "x": 750, "y": 1200 }, "data": { "label": "h1" } },
        { "id": "n_b1_op1_avgpool", "type": "avgpool2dNode", "position": { "x": 1000, "y": 1100 }, "data": { "kernel_size": 3, "stride": 1, "padding": 1 } },
        { "id": "n_b1_op2_sepconv_3x3", "type": "conv2dNode", "position": { "x": 1000, "y": 700 }, "data": { "in_channels": 48, "out_channels": 48, "kernel_size": 3, "padding": 1, "groups": 48 } },
        { "id": "n_b1_add", "type": "addNode", "position": { "x": 1250, "y": 900 }, "data": {} },
        { "id": "n_b2_op1_maxpool", "type": "maxpool2dNode", "position": { "x": 1000, "y": 1300 }, "data": { "kernel_size": 3, "stride": 1, "padding": 1 } },
        { "id": "n_b2_op2_sepconv_7x7", "type": "conv2dNode", "position": { "x": 1450, "y": 900 }, "data": { "in_channels": 48, "out_channels": 48, "kernel_size": 7, "padding": 3, "groups": 48 } },
        { "id": "n_b2_add", "type": "addNode", "position": { "x": 1700, "y": 1100 }, "data": {} },
        { "id": "normal_cell_concat", "type": "concatenateNode", "position": { "x": 1950, "y": 1000 }, "data": { "dim": 1, "inputs": 2 } },
        { "id": "normal_cell_proj", "type": "conv2dNode", "position": { "x": 2200, "y": 1000 }, "data": { "in_channels": 96, "out_channels": 48, "kernel_size": 1, "label": "Normal Cell Output (h2)" } },

        { "id": "reduction_cell_prev_input", "type": "identityNode", "position": { "x": 2450, "y": 800 }, "data": { "label": "h1" } },
        { "id": "reduction_cell_curr_input", "type": "identityNode", "position": { "x": 2450, "y": 1200 }, "data": { "label": "h2" } },
        { "id": "r_b1_op1_maxpool", "type": "maxpool2dNode", "position": { "x": 2700, "y": 700 }, "data": { "kernel_size": 3, "stride": 2, "padding": 1 } },
        { "id": "r_b1_op2_sepconv_7x7", "type": "conv2dNode", "position": { "x": 2700, "y": 900 }, "data": { "in_channels": 48, "out_channels": 48, "kernel_size": 7, "stride": 2, "padding": 3, "groups": 48 } },
        { "id": "r_b1_add", "type": "addNode", "position": { "x": 2950, "y": 800 }, "data": {} },
        { "id": "r_b2_op1_avgpool", "type": "avgpool2dNode", "position": { "x": 2700, "y": 1100 }, "data": { "kernel_size": 3, "stride": 2, "padding": 1 } },
        { "id": "r_b2_op2_sepconv_5x5", "type": "conv2dNode", "position": { "x": 2700, "y": 1300 }, "data": { "in_channels": 48, "out_channels": 48, "kernel_size": 5, "stride": 2, "padding": 2, "groups": 48 } },
        { "id": "r_b2_add", "type": "addNode", "position": { "x": 2950, "y": 1200 }, "data": {} },
        { "id": "reduction_cell_concat", "type": "concatenateNode", "position": { "x": 3200, "y": 1000 }, "data": { "dim": 1, "inputs": 2 } },
        { "id": "reduction_cell_proj", "type": "conv2dNode", "position": { "x": 3450, "y": 1000 }, "data": { "in_channels": 96, "out_channels": 96, "kernel_size": 1, "label": "Reduction Cell Output (h3)" } },

        { "id": "head_pool", "type": "adaptiveavgpool2dNode", "position": { "x": 3700, "y": 1000 }, "data": { "output_size": [1, 1] } },
        { "id": "head_flatten", "type": "flattenNode", "position": { "x": 3950, "y": 1000 }, "data": {} },
        { "id": "head_classifier", "type": "linearNode", "position": { "x": 4200, "y": 1000 }, "data": { "in_features": 96, "out_features": 1000 } }
    ],
    "edges": [
        { "id": "s_in-s_conv", "source": "stem_input", "target": "stem_conv" },
        { "id": "s_conv-s_bn", "source": "stem_conv", "target": "stem_bn" },

        { "id": "s_bn-nc_prev", "source": "stem_bn", "target": "normal_cell_prev_input" },
        { "id": "s_bn-nc_curr", "source": "stem_bn", "target": "normal_cell_curr_input" },

        { "id": "nc_curr-n_b1_op1", "source": "normal_cell_curr_input", "target": "n_b1_op1_avgpool" },
        { "id": "nc_prev-n_b1_op2", "source": "normal_cell_prev_input", "target": "n_b1_op2_sepconv_3x3" },
        { "id": "n_b1_op1-n_b1_add", "source": "n_b1_op1_avgpool", "target": "n_b1_add", "targetHandle": "input1" },
        { "id": "n_b1_op2-n_b1_add", "source": "n_b1_op2_sepconv_3x3", "target": "n_b1_add", "targetHandle": "input2" },
        { "id": "nc_curr-n_b2_op1", "source": "normal_cell_curr_input", "target": "n_b2_op1_maxpool" },
        { "id": "n_b1_add-n_b2_op2", "source": "n_b1_add", "target": "n_b2_op2_sepconv_7x7" },
        { "id": "n_b2_op1-n_b2_add", "source": "n_b2_op1_maxpool", "target": "n_b2_add", "targetHandle": "input1" },
        { "id": "n_b2_op2-n_b2_add", "source": "n_b2_op2_sepconv_7x7", "target": "n_b2_add", "targetHandle": "input2" },
        { "id": "n_b1_add-nc_concat", "source": "n_b1_add", "target": "normal_cell_concat", "targetHandle": "input1" },
        { "id": "n_b2_add-nc_concat", "source": "n_b2_add", "target": "normal_cell_concat", "targetHandle": "input2" },
        { "id": "nc_concat-nc_proj", "source": "normal_cell_concat", "target": "normal_cell_proj" },

        { "id": "s_bn-rc_prev", "source": "stem_bn", "target": "reduction_cell_prev_input" },
        { "id": "nc_proj-rc_curr", "source": "normal_cell_proj", "target": "reduction_cell_curr_input" },

        { "id": "rc_prev-r_b1_op1", "source": "reduction_cell_prev_input", "target": "r_b1_op1_maxpool" },
        { "id": "rc_curr-r_b1_op2", "source": "reduction_cell_curr_input", "target": "r_b1_op2_sepconv_7x7" },
        { "id": "r_b1_op1-r_b1_add", "source": "r_b1_op1_maxpool", "target": "r_b1_add", "targetHandle": "input1" },
        { "id": "r_b1_op2-r_b1_add", "source": "r_b1_op2_sepconv_7x7", "target": "r_b1_add", "targetHandle": "input2" },
        { "id": "rc_prev-r_b2_op1", "source": "reduction_cell_prev_input", "target": "r_b2_op1_avgpool" },
        { "id": "rc_curr-r_b2_op2", "source": "reduction_cell_curr_input", "target": "r_b2_op2_sepconv_5x5" },
        { "id": "r_b2_op1-r_b2_add", "source": "r_b2_op1_avgpool", "target": "r_b2_add", "targetHandle": "input1" },
        { "id": "r_b2_op2-r_b2_add", "source": "r_b2_op2_sepconv_5x5", "target": "r_b2_add", "targetHandle": "input2" },
        { "id": "r_b1_add-rc_concat", "source": "r_b1_add", "target": "reduction_cell_concat", "targetHandle": "input1" },
        { "id": "r_b2_add-rc_concat", "source": "r_b2_add", "target": "reduction_cell_concat", "targetHandle": "input2" },
        { "id": "rc_concat-rc_proj", "source": "reduction_cell_concat", "target": "reduction_cell_proj" },

        { "id": "rc_proj-h_pool", "source": "reduction_cell_proj", "target": "head_pool" },
        { "id": "h_pool-h_flatten", "source": "head_pool", "target": "head_flatten" },
        { "id": "h_flatten-h_class", "source": "head_flatten", "target": "head_classifier" }
    ]
}